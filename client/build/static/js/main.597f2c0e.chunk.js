(this["webpackJsonpactivity5-frontend"]=this["webpackJsonpactivity5-frontend"]||[]).push([[0],{17:function(e,t,a){e.exports={header:"navbar_header__1OM8g",logo:"navbar_logo__2Cm66",active:"navbar_active__3weRW",badge:"navbar_badge__3C7Og"}},26:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a(19),r=(a(26),a(9)),c=a(3),o=a(2),i=a(4),l=a(0),u="auth",d=localStorage.getItem(u),j=d?{status:"authenticated",accessToken:d}:{status:"anonymous",accessToken:null},b=Object(n.createContext)(),m=function(e,t){switch(t.type){case"login":return{accessToken:t.accessToken,status:"authenticated"};case"logout":return{accessToken:null,status:"anonymous"};default:throw new Error("Unsupported event type ".concat(t.type," in authReducer"))}},p=function(e){var t=e.children,a=function(){var e=Object(n.useReducer)(m,j),t=Object(i.a)(e,2),a=t[0],s=t[1];return Object(o.a)(Object(o.a)({},a),{},{login:function(e){return s({type:"login",accessToken:e})},logout:function(){return s({type:"logout"})}})}();return Object(l.jsx)(b.Provider,{value:a,children:t})},h=function(){var e=Object(n.useContext)(b);if(!e)throw new Error("Your application must be wrapped with AuthProvider");return e},x=function(){if(!Object(n.useContext)(b))throw new Error("Your application must be wrapped with AuthProvider");return function(e){return function(e,t,a){return fetch("".concat("api","/register"),{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:a})}).then((function(e){return e.ok?e.json():Promise.reject(e)}))}(e.username,e.email,e.password)}},f=function(){if(!Object(n.useContext)(b))throw new Error("Your application must be wrapped with AuthProvider");return function(e){return function(e,t){return fetch("".concat("api","/login"),{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject(e)}))}(e.email,e.password)}},g=a(12),O=a(11),v=a.n(O),y=function(e){var t=e.type,a=void 0===t?"button":t,n=e.variant,s=e.render,r=Object(g.a)(e,["type","variant","render"]),c=v()("inline-flex justify-center items-center py-2 px-4 border shadow-sm text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500",n&&w[n],r.className);return s?s(Object(o.a)({className:c},r)):Object(l.jsx)("button",Object(o.a)(Object(o.a)({type:a},r),{},{className:c}))},w={primary:"border-transparent text-white bg-pink-600 hover:bg-pink-700",outline:"border-pink-500 text-pink-500 bg-white hover:text-pink-700"},N=0,k=n.createContext();k.displayName="FieldContext";var S=function(e){var t=e.fieldId,a=e.children,s=function(e){var t=n.useState((function(){return e||String(N++)}));return Object(i.a)(t,1)[0]}(t);return Object(l.jsx)(k.Provider,{value:s,children:Object(l.jsx)("div",{className:"space-y-1",children:a})})},C=function(e){var t=n.useContext(k);return Object(l.jsx)("label",Object(o.a)(Object(o.a)({htmlFor:t},e),{},{className:v()("block text-sm font-medium text-gray-900",e.className)}))};function T(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];t.forEach((function(e){return"function"===typeof e&&e.apply(void 0,a)}))}}var P=n.forwardRef((function(e,t){var a=e.type,s=void 0===a?"text":a,r=e.onChangeValue,c=Object(g.a)(e,["type","onChangeValue"]),i=n.useContext(k);return Object(l.jsx)("input",Object(o.a)(Object(o.a)({type:s},c),{},{id:c.id||i,className:v()("block w-full shadow-sm sm:text-sm focus:ring-pink-500 focus:border-pink-500 border-gray-300 rounded-md",c.className),onChange:T(r&&function(e){return r(e.target.value)},c.onChange),ref:t}))})),_=n.forwardRef((function(e,t){var a=e.label,n=e.id,s=Object(g.a)(e,["label","id"]);return Object(l.jsxs)(S,{fieldId:n,children:[a&&Object(l.jsx)(C,{children:a}),Object(l.jsx)(P,Object(o.a)(Object(o.a)({},s),{},{ref:t}))]})})),A=function(){var e={message:"",status:"idle"},t=n.useState(""),a=Object(i.a)(t,2),s=a[0],c=a[1],u=n.useState(""),d=Object(i.a)(u,2),j=d[0],b=d[1],m=n.useState(e),p=Object(i.a)(m,2),x=p[0],g=p[1],O=f(),v=h();return Object(l.jsxs)("div",{className:"max-w-md mx-auto m-6 shadow",children:[Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),g(Object(o.a)(Object(o.a)({},x),{},{status:"loading"})),O({email:s,password:j}).then((function(t){v.login(t.token),localStorage.setItem("auth",t.token),g(e)})).catch((function(e){console.log(e.status,e.statusText),e.json().then((function(e){console.log(e),g({message:e.errors,status:"errors"})}))}))},className:"p-6",children:["errors"===x.status&&Object(l.jsx)("div",{className:"p-2 text-red-800 bg-red-200 rounded-sm",children:x.message}),Object(l.jsx)("div",{className:"text-3xl mt-4 mb-8 font-extrabold text-center",children:"Login"}),Object(l.jsxs)("div",{className:"space-y-6",children:[Object(l.jsx)(_,{label:"Email",value:s,onChangeValue:c,name:"username",id:"username",autoFocus:!0,required:!0,disabled:"loading"===x.status}),Object(l.jsx)(_,{label:"Password",value:j,onChangeValue:b,name:"password",id:"password",type:"password",required:!0,disabled:"loading"===x.status}),Object(l.jsx)(y,{type:"submit",variant:"primary",className:"w-full",disabled:"loading"===x.status,children:"Login"})]})]}),Object(l.jsx)("div",{className:"text-xl m-5  font-bold text-center",children:Object(l.jsx)(r.b,{className:"underline text-center text-md leading-relaxed text-pink-500",to:"/register",children:"Register"})})]})},E=function(){var e=function(){var e=Object(n.useContext)(b);if(!e)throw new Error("Your application must be wrapped with AuthProvider");return function(){e.logout(),localStorage.removeItem(u),localStorage.removeItem("page")}}();return"anonymous"===h().status?null:Object(l.jsx)(y,{variant:"primary",onClick:e,children:"Logout"})},V=a(17),q=a.n(V),I=function(){return Object(l.jsxs)("header",{className:q.a.header,children:[Object(l.jsx)("div",{className:q.a.logo,children:"BackendDev Homeworks Day2"}),Object(l.jsx)("nav",{children:Object(l.jsxs)("ul",{children:[Object(l.jsx)("li",{children:Object(l.jsx)(r.b,{to:"/",children:"User Profile"})}),Object(l.jsx)("li",{children:Object(l.jsx)(E,{})})]})})]})},F=function(e){var t=h();return Object(l.jsxs)("div",{children:["authenticated"===t.status?Object(l.jsx)(I,{}):Object(l.jsx)(c.a,{to:"/"}),Object(l.jsx)("main",{children:e.children})]})},R=function(){var e={message:"",status:"idle"},t=n.useState(""),a=Object(i.a)(t,2),s=a[0],u=a[1],d=n.useState(""),j=Object(i.a)(d,2),b=j[0],m=j[1],p=n.useState(""),g=Object(i.a)(p,2),O=g[0],v=g[1],w=n.useState(e),N=Object(i.a)(w,2),k=N[0],S=N[1],C=h(),T=f(),P=x(),A=Object(c.g)();return Object(l.jsxs)("div",{className:"max-w-md mx-auto m-10 shadow",children:[Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),S(Object(o.a)(Object(o.a)({},k),{},{status:"loading"})),P({username:s,email:b,password:O}).then((function(t){T({email:b,password:O}).then((function(t){C.login(t.token),localStorage.setItem("auth",t.token),S(e)})),A.push("/")})).catch((function(e){console.log(e.status,e.statusText),e.json().then((function(e){console.log(e),S({message:e.errors,status:"errors"})}))}))},className:"p-6",children:["errors"===k.status&&Object(l.jsx)("div",{className:"p-2 text-red-800 bg-red-200 rounded-sm",children:k.message}),Object(l.jsx)("div",{className:"text-3xl mt-4 mb-8 font-extrabold text-center",children:"Register User"}),Object(l.jsxs)("div",{className:"space-y-6",children:[Object(l.jsx)(_,{label:"Username",value:s,onChangeValue:u,name:"username",id:"username",autoFocus:!0,required:!0,disabled:"loading"===k.status}),Object(l.jsx)(_,{label:"Email",value:b,onChangeValue:m,name:"email",id:"email",autoFocus:!0,required:!0,disabled:"loading"===k.status}),Object(l.jsx)(_,{label:"Password",value:O,onChangeValue:v,name:"password",id:"password",type:"password",required:!0,disabled:"loading"===k.status}),Object(l.jsx)(y,{type:"submit",variant:"primary",className:"w-full",disabled:"loading"===k.status,children:"Register"})]})]}),Object(l.jsx)("div",{className:"text-xl m-5  font-bold text-center",children:Object(l.jsx)(r.b,{className:"underline text-center text-md leading-relaxed text-pink-500",to:"/",children:"Back to Homepage"})})]})},D=(a(36),function(){var e=n.useState(""),t=Object(i.a)(e,2),a=t[0],s=t[1],r=n.useState(""),u=Object(i.a)(r,2),d=u[0],j=u[1],b=n.useState(""),m=Object(i.a)(b,2),p=m[0],x=m[1],f=n.useState(!1),g=Object(i.a)(f,2),O=(g[0],g[1]),v=n.useState({message:"",status:"idle"}),w=Object(i.a)(v,2),N=w[0],k=w[1],S=Object(c.g)(),C=h(),T=new AbortController,P=function(e,t){O(!0),function(e,t){return fetch("".concat("api","/user-details"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},signal:t}).then((function(e){return e.ok?e.json():Promise.reject(e)}))}(e,t).then((function(e){var t=e.company,a=e.department,n=e.designation;s(t),j(a),x(n),O(!1)})).catch((function(e){console.log(e.status,e.statusText),e.json().then((function(e){console.log(e),k({message:e.errors,status:"errors"})}))}))};return n.useEffect((function(){if("authenticated"===C.status){var e=localStorage.getItem("auth");return P(e,T.signal),function(){T.abort()}}}),[C]),Object(l.jsx)("div",{className:"max-w-md mx-auto m-10 shadow",children:Object(l.jsxs)("form",{onSubmit:function(e){(e.preventDefault(),k(Object(o.a)(Object(o.a)({},N),{},{status:"loading"})),"authenticated"===C.status)&&function(e,t){var a=t.company,n=t.department,s=t.designation;return fetch("".concat("api","/user-details"),{method:"POST",headers:{accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({company:a,department:n,designation:s})}).then((function(e){return e.ok?e.json():Promise.reject(e)}))}(localStorage.getItem("auth"),{company:a,department:d,designation:p}).then((function(e){var t=e.company,a=e.department,n=e.designation;s(t),j(a),x(n),k(Object(o.a)(Object(o.a)({},N),{},{status:"idle"})),S.push("/")})).catch((function(e){console.log(e.status,e.statusText),e.json().then((function(e){console.log(e),k({message:e.errors,status:"errors"})}))}))},className:"p-6",children:["errors"===N.status&&Object(l.jsx)("div",{className:"p-2 text-red-800 bg-red-200 rounded-sm",children:N.message}),Object(l.jsxs)("div",{className:"space-y-6",children:[Object(l.jsx)(_,{label:"Company",value:a,onChangeValue:s,name:"company",id:"company",autoFocus:!0,required:!0,disabled:"loading"===N.status}),Object(l.jsx)(_,{label:"Department",value:d,onChangeValue:j,name:"department",id:"department",autoFocus:!0,required:!0,disabled:"loading"===N.status}),Object(l.jsx)(_,{label:"Designation",value:p,onChangeValue:x,name:"designation",id:"designation",required:!0,disabled:"loading"===N.status}),Object(l.jsx)(y,{type:"submit",variant:"primary",className:"w-full",disabled:"loading"===N.status,children:"Update"})]})]})})}),U=function(){var e=h();return Object(l.jsxs)(l.Fragment,{children:["anonymous"===e.status&&Object(l.jsx)("main",{className:"bg-gray-50 p-6 sm:p-12 min-h-screen",children:Object(l.jsx)("div",{className:"max-w-7xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:px-8",children:Object(l.jsx)(A,{})})}),"authenticated"===e.status&&Object(l.jsx)("main",{className:"bg-gray-50 lg:flex",children:Object(l.jsx)("div",{className:"flex-1",children:Object(l.jsxs)("div",{className:"max-w-7xl mx-auto pt-10 pb-24 px-4 sm:px-6 lg:px-8",children:[Object(l.jsx)("div",{className:"sm:flex sm:flex-col sm:align-center",children:Object(l.jsx)("h1",{className:"text-5xl font-extrabold text-pink-700 sm:text-center",children:"User Profile"})}),Object(l.jsx)("div",{children:Object(l.jsx)(D,{})})]})})})]})};var J=function(){return Object(l.jsx)(F,{children:Object(l.jsxs)(c.d,{children:[Object(l.jsx)(c.b,{path:"/",exact:!0,children:Object(l.jsx)(U,{})}),Object(l.jsx)(c.b,{path:"/register",children:Object(l.jsx)(R,{})})]})})};s.render(Object(l.jsx)(p,{children:Object(l.jsx)(r.a,{children:Object(l.jsx)(J,{})})}),document.querySelector("#root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.597f2c0e.chunk.js.map